<script>
    function add_css(css, parent_node) {
        let style = document.createElement("style");
        style.setAttribute("type", "text/css");
        style.appendChild(document.createTextNode(css));
        style.className = "injected_dependency";

        parent_node.appendChild(style);
    }

    function add_js(js, parent_node) {
        let script = document.createElement("script");
        script.type = "text/javascript";
        script.text = js;
        script.className = "injected_dependency";

        parent_node.appendChild(script);
    }

    function delete_injected_dependencies(parent_node) {
        let injected_dependencies = parent_node.getElementsByClassName("injected_dependency");
        // for whatever reason this can't be done with a normal for loop
        // so have fun deleting elements like a cave man ;)
        while (injected_dependencies.length) {
            injected_dependencies[0].parentNode.removeChild(injected_dependencies[0]);
            injected_dependencies = parent_node.getElementsByClassName("injected_dependency");
        }
    }

    function get_current_notebook() {
        return document.currentScript.closest(".jp-Notebook");
    }

    (function () {
        let notebook = get_current_notebook();
        delete_injected_dependencies(notebook);
        add_js("{{ js }}", notebook);
    })()
</script>
